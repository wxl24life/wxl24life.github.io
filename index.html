<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="有椒其馨,胡考之宁">
<meta property="og:type" content="website">
<meta property="og:title" content="wxl24life&#39;s blog">
<meta property="og:url" content="http://wxl24life.com/index.html">
<meta property="og:site_name" content="wxl24life&#39;s blog">
<meta property="og:description" content="有椒其馨,胡考之宁">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="wxl24life&#39;s blog">
<meta name="twitter:description" content="有椒其馨,胡考之宁">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://wxl24life.com/">





  <title>wxl24life's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">wxl24life's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            站点地图
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2020/03/05/ddia-book-database-index/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/05/ddia-book-database-index/" itemprop="url">DDIA 笔记之数据库与索引</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-05T14:17:53+08:00">
                2020-03-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2020/03/05/ddia-book-database-index/" class="leancloud_visitors" data-flag-title="DDIA 笔记之数据库与索引">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>数据库最核心的功能是存储和检索 - 以某种格式存储到某种存储介质，之后通过某种查询方式（例如 SQL 或者 API）进行检索。</p>
<p>最简单的存储方式基于日志，以追加式的方式实现，数据按照写入顺序排列。比如日志以 CSV 格式顺序追加到文件里，数据的增删改都以单独的一条记录存储在日志里。</p>
<p>基于日志的存储在写性能方面优势明显，主要问题是检索的效率太差，需要逐个遍历每条记录。</p>
<p>为了提升数据检索的效率，我们考虑维护 ** 索引 ** 结构。索引在提升读访问性能时会增加写操作的维护成本，减慢写的速度，因此应该根据数据访问需要，只创建必要的索引。</p>
<p>最简单的索引结构是哈希表，在内存中维护每个 key 和该 key 在日志文件里的偏移量。这种方式要求内存足够容下所有 key (对 value 的数据大小没有要求）。</p>
<p>追加日志文件的方式通常与文件分段、压缩、合并等操作相结合。</p>
<ul>
<li>分段可以避免单个文件过大进而最终用尽磁盘</li>
<li>分段是将文件分成一定大小的段，当文件达到大小阈值时就关闭它，后续写入维护到新的段文件里</li>
<li>可以在段上执行压缩，将日志中重复的键丢弃，只保留最近的更新</li>
<li>压缩会使得段变小，可以在执行压缩的同时将多个段合并在一起并写入新的文件，整个过程可以在后台异步完成，压缩合并执行过程中，可以继续用旧的段文件进行读写请求</li>
<li>合并使得段的数量减少，可以有效减少数据查询操作需要检查的段数量</li>
</ul>
<p>其他的一些重要考量因素：</p>
<ol>
<li>数据格式：用二进制格式替换 CSV</li>
<li>对于删除记录，也追加到文件中，称为墓碑记录</li>
<li>考虑到崩溃后需要恢复内存 hashmap，可以在磁盘上维护每个段文件对应 hashmap 的内存快照</li>
<li>部分写入的记录可以通过校验值的方式发现并丢弃</li>
<li>并发控制的选择考虑用单个写线程负责数据文件的追加，保证写入先后顺序</li>
</ol>
<p>追加日志相比原地更新文件的好处：</p>
<ol>
<li>顺序写速度远高于随机写</li>
<li>因为段文件的追加或不可变的，并发和崩溃恢复起来简单很多</li>
<li>文件合并可以避免碎片化问题</li>
</ol>
<p>哈希索引的局限：</p>
<ol>
<li>必须全部维护到内存，不适合大量键的场景。如果考虑磁盘维护哈希表？性能很难表现良好，几个原因：1. 需要大量随机 I/O 访问 2. 哈希表满了之后扩容代价昂贵 3. 解决哈希冲突的复杂性</li>
<li>区间查询效率不高，只能针对区间内的每个值单独查询</li>
</ol>
<hr>
<p>最简单的日志存储方式，每个段文件里存储一组 key-value 对且按照写入顺序排列。如果希望日志里的数据按照 key 排列，如何重新设计段文件的格式。</p>
<p>下面引入 SSTable - 排序字符串表。</p>
<ol>
<li>因为段文件有序，合并端变得简单高效，采用类似归并排序的合并方法即可。</li>
<li>可以采用稀疏索引，不需要在内存中维护所有键的索引</li>
<li>可以按区间维护块并在写磁盘前进行压缩，稀疏内存索引指向压缩快的开头，既节省空间又减少了 I/O 带宽</li>
</ol>
<p>如何构建和维护 SSTable？如何保证磁盘段文件里的数据按照 key 排序。</p>
<p>B-Tree 可以直接在磁盘上维护排序结构，不过与之相比，在内存中维护排序结构会容易很多。</p>
<p>内存排序可以考虑红黑树或者 AVL 树等平衡二叉树结构，这种结构支持任意顺序写入并以排序后的顺序读取它们。</p>
<p>存储工作流程如下：</p>
<ol>
<li>内存中维护内存表，选用平衡二叉树（例如红黑树）作为存储结构。写入时，将数据写入内存表。</li>
<li>内存表大小达到阈值，将其作为 SSTable 文件写入磁盘。</li>
<li>对于读请求，先在内存表中查找，然后是最新的磁盘段文件，以此类推。</li>
<li>后台进程周期性地合并压缩段文件</li>
</ol>
<p>上述过程存在的问题是，如果遇到数据库崩溃，内存表中的最近写入数据将丢失。为此，需要在磁盘保留单独的 WAL 日志。</p>
<hr>
<p>SSTable 及内存表的术语来源于 Google 的 Bigtable 论文，整体是基于合并和压缩排序日志文件的原理，属于 LSM-Tree (Log-Structured Merge Tree，日志结构的合并树)。<br>很多存储引擎的实现都采用了类似的结构，统称为 LSM 存储引擎，例如 Cassandra、HBase 以及全文搜索系统所使用的索引引擎 Lucene。</p>
<p>对于不存在的 key 值检索，按照 LSM-Tree 的算法，需要轮流遍历内存表和从新到旧的每一个 SSTable 段文件，因此效率很差。为此，存储引擎会引入额外的布隆过滤器，如果数据库中不存在某个键，会直接通过内存里的布隆过滤器找到答案。</p>
<p>关于 SSTable 的压缩合并时机，HBase 采用了大小分级的压缩方式，区分为 Major Compact 和 Minor Compact。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2020/01/16/redis-persistence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/16/redis-persistence/" itemprop="url">Redis 的持久化机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-16T13:59:24+08:00">
                2020-01-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2020/01/16/redis-persistence/" class="leancloud_visitors" data-flag-title="Redis 的持久化机制">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>redis 提供了两种持久化机制：rdb 和 AOF。</p>
<h3 id="一、rdb-方式"><a href="#一、rdb-方式" class="headerlink" title="一、rdb 方式"></a>一、rdb 方式</h3><p>rdb 通过快照的方式定期对 redis 某个时刻的数据做磁盘备份。相比 AOF，rdb 文件恢复数据更快一些，文件紧凑，适合数据备份。使用子进程的方式进行异步数据备份，对 redis 服务器的性能影响是最小的。</p>
<h3 id="1-1-如何开启-rdb-持久化"><a href="#1-1-如何开启-rdb-持久化" class="headerlink" title="1.1 如何开启 rdb 持久化"></a>1.1 如何开启 rdb 持久化</h3><ol>
<li>同步命令：通过客户端向服务器发送 save（同步的方式，会阻塞服务器其他请求，不要在生产环境执行 save）</li>
<li>异步命令：bgsave 命令触发 redis 服务主进程 fork 一个子进程来同步数据到 rdb 文件。注意子进程 fork 的过程是同步操作，如果 fork 子进程花费太长时间，也会阻塞其他请求。</li>
<li>通过配置指定触发条件。执行类似 bgsave，不推荐这种方式触发 rdb，频率控制的不当会造成不同的后果：过频繁，造成压力；间隔太长，数据丢失问题。</li>
</ol>
<h3 id="1-2-rdb-方式主要问题"><a href="#1-2-rdb-方式主要问题" class="headerlink" title="1.2 rdb 方式主要问题"></a>1.2 rdb 方式主要问题</h3><ol>
<li>由于两次 rdb 之间会有时间间隔，如果 redis 实例恰好在此期间挂掉，那么回造成两次 rdb 之间的数据丢失。</li>
<li>通过 save 命令触发 rdb 时会造成服务阻塞，直到数据同步完成才能接受后续请求。</li>
<li>使用 bgsave 命令在 fork 子进程时，如果数据量太大，fork 的过程也会阻塞；另外，fork 子进程会耗费内存。</li>
</ol>
<h2 id="二、AOF（append-only-file）"><a href="#二、AOF（append-only-file）" class="headerlink" title="二、AOF（append-only file）"></a>二、AOF（append-only file）</h2><p>AOF 持久化方式会记录客户端对服务器的每一次写操作命令，并将这些写操作以 redis 协议追加保存到以后缀为 aof 文件末尾。<br>在 redis 重启时，会加载并运行 aof 文件的命令，以达到数据恢复的目的。</p>
<p>默认不开启，通过配置文件的方式开启 aof 持久化。</p>
<h3 id="2-1-三种不同保障级别的写入策略（通过-appendsync-选项指定）"><a href="#2-1-三种不同保障级别的写入策略（通过-appendsync-选项指定）" class="headerlink" title="2.1 三种不同保障级别的写入策略（通过 appendsync 选项指定）"></a>2.1 三种不同保障级别的写入策略（通过 appendsync 选项指定）</h3><ol>
<li>always: 最安全也是最耗费资源（每个写都有 IO 操作）的一种策略，每个写操作都要保存到 aof 文件中</li>
<li>everysec：默认写入策略，每秒写一次。最多会丢失 1s 的数据</li>
<li>no：redis 服务器不负责写入 aof，交给操作系统来决定什么时候写 aof；最快也是最不安全的选择，不推荐使用。</li>
</ol>
<h3 id="2-2-AOF-文件重写"><a href="#2-2-AOF-文件重写" class="headerlink" title="2.2 AOF 文件重写"></a>2.2 AOF 文件重写</h3><p>开辟一个子进程对内存进行遍历，转换成一系列 redis 的操作指令，序列化成一个新的 aof 日志文件。<br>效果类似于对某个 key 的多次操作压缩合并成为一条指令，有助于降低 aof 文件的磁盘占用，从而有助于加快数据恢复的速度。</p>
<p>支持不开启重写（默认) 和让服务器异步重写追加 aof 文件命令（bgrewriteaof)。</p>
<h3 id="2-3-AOF-的优缺点"><a href="#2-3-AOF-的优缺点" class="headerlink" title="2.3 AOF 的优缺点"></a>2.3 AOF 的优缺点</h3><p>优点只是追加日志文件，对服务器性能影响较小，速度比 rdb 更快，消耗的内存较少。<br>缺点主要是生成的 aof 日志文件太大，恢复数据的速度比 rdb 慢。</p>
<h2 id="三、其他-notes"><a href="#三、其他-notes" class="headerlink" title="三、其他 notes"></a>三、其他 notes</h2><ol>
<li><p>当 rdb 和 aof 两种方式都开启时，redis 优先使用 aof 日志来恢复数据，因为 aof 保存的文件更完整。</p>
</li>
<li><p>从运维实践的角度，如何应用 rdb 和 aof 持久化机制。</p>
<p> 先说快照的方式，它通过开启子进程的方式进行，fork 是比较耗费资源的操作。全量快照需要遍历整个内存，大块写磁盘也会加重系统负载。<br> AOF 的 fsync（异步刷盘）是一个耗时的 IO 操作，会降低 redis 性能，也会增加系统 IO 负担。</p>
<p> 运维实践中，通常 redis 的主节点不会进行持久化操作，持久化交给从节点进行。注意网络分区造成主从数据不一致问题，做好监控，也应该增加一个从节点，避免数据丢失。</p>
</li>
<li><p>redis 4.0 提供的混合持久化机制</p>
<p> 重启 redis 很少使用 rdb 来恢复数据，因为可能存在大量数据丢失。aof 文件过大，恢复数据太慢。<br> 混合持久化机制是结合 rdb 的数据恢复速度和 aof 的数据完整性，先恢复 rdb 数据，之后通过 aof 回放 rdb 丢失的增量数据。</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/12/23/java-thread-pooling-techniques/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/23/java-thread-pooling-techniques/" itemprop="url">Java 线程池实现 Notes 及 Pooling 技术的应用 - 数据库连接池</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-23T19:48:24+08:00">
                2019-12-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/12/23/java-thread-pooling-techniques/" class="leancloud_visitors" data-flag-title="Java 线程池实现 Notes 及 Pooling 技术的应用 - 数据库连接池">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>最基本的线程池类 ThreadPoolExecutor 完整的构造器方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public ThreadPoolExecutor (int corePoolSize,</span><br><span class="line">                          int maximumPoolSize,</span><br><span class="line">                          long keepAliveTime,</span><br><span class="line">                          TimeUnit unit,</span><br><span class="line">                          BlockingQueue&lt;Runnable&gt; workQueue,</span><br><span class="line">                          ThreadFactory threadFactory,</span><br><span class="line">                          RejectedExecutionHandler handler)</span><br></pre></td></tr></table></figure>

<p>以下针对 Java doc 文档做几点说明（参考 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html" target="_blank" rel="noopener">Java doc</a>）</p>
<h3 id="一、关于-pool-里-thread-的创建时机"><a href="#一、关于-pool-里-thread-的创建时机" class="headerlink" title="一、关于 pool 里 thread 的创建时机"></a>一、关于 pool 里 thread 的创建时机</h3><p>“By default, even core threads are initially created and started only when new tasks arrive”</p>
<p>可以通过 prestartCoreThread () or prestartAllCoreThreads () 修改默认行为：分别预启动一个 coreThread 和所有 core threads. 例如下面的场景下可能需要 prestartAllCoreThreads：</p>
<p>“You probably want to prestart threads <strong>if you construct the pool with a non-empty queue</strong>.”</p>
<p>When a new task is submitted in method execute (java.lang.Runnable)</p>
<ul>
<li><p>If fewer than corePoolSize threads are running, a new thread is created to handle the request, even if other worker threads are idle. </p>
</li>
<li><p>If there are more than corePoolSize but less than maximumPoolSize threads running, <em>a new thread will be created only if the queue is full</em>.</p>
</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/12/23/java-thread-pooling-techniques/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/12/06/java-multidimensional-array-initialize-with-arraysfill/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/06/java-multidimensional-array-initialize-with-arraysfill/" itemprop="url">Java 里 Arrays.fill () 对二维（多维）数组赋值</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-06T06:47:20+08:00">
                2019-12-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/12/06/java-multidimensional-array-initialize-with-arraysfill/" class="leancloud_visitors" data-flag-title="Java 里 Arrays.fill () 对二维（多维）数组赋值">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Java 提供了丰富的数组及集合操作 libarary。其中使用 <code>Arrays.fill (a, val)</code> 可以方便地将数组 a 的所有值赋值为 val。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] tmp = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>]; <span class="comment">// 创建大小为 10 的一维整型数组，初始值为 0</span></span><br><span class="line">Arrays.fill (tmp, -<span class="number">1</span>); <span class="comment">// 将所有的数组值重置为 -1</span></span><br></pre></td></tr></table></figure>

<p>接下来看二维数组的场景，看一段代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[][] intervalArray = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>][<span class="number">2</span>];</span><br><span class="line"><span class="comment">// 希望将二维数组的初始值赋值为 [-1, -1]</span></span><br><span class="line">Arrays.fill (intervalArray, <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length (); i++) &#123;</span><br><span class="line">    <span class="keyword">int</span> letterIdx = s.charAt (i) - <span class="string">'a'</span>;</span><br><span class="line">    <span class="keyword">if</span> (intervalArray [letterIdx][<span class="number">0</span>] == -<span class="number">1</span>) &#123;</span><br><span class="line">        intervalArray [letterIdx][<span class="number">0</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    intervalArray [letterIdx][<span class="number">1</span>] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">    System.out.println (Arrays.toString (intervalArray [i]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/12/06/java-multidimensional-array-initialize-with-arraysfill/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/09/29/rainy-mood-calm-yourself-down/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/29/rainy-mood-calm-yourself-down/" itemprop="url">rainymood - 收拾心情</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-29T09:37:47+08:00">
                2019-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/09/29/rainy-mood-calm-yourself-down/" class="leancloud_visitors" data-flag-title="rainymood - 收拾心情">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>连续两天做了噩梦，分别梦到了自己被蛇咬和女儿身处险境但是自己却与她隔海相望。做噩梦有可能是因为压力有些大，身心需要一些调剂。</p>
<p>昨天八个半月大的女儿开口喊爸爸妈妈，算是对我们一种莫大的慰藉，做噩梦梦到女儿可能跟这个场景也有关系:-)。婴儿很神奇，当他们在探索世界的过程中，每当刚学会一个新的本领，都会很积极地不断练习，直到变得熟练。女儿之前练习爬行，在自己有意愿主动爬之前各种排斥，当她慢慢习得这个技能之后，爬行变得非常轻松。开口说话大抵应该也会是类似的过程。</p>
<p>今天是十一前调休后的工作日，早上来了之后带上耳麦，打开了收藏很久的 rainymood，听到了熟悉的打雷下雨的声音。雨天是我最喜欢的天气，平日嘈杂的各种声音停下来，只能听到下雨的声音，确实是最安静和舒适的，再搭配上轻音乐，那是最完美的。</p>
<p>今天在 rainymood 干净的页面上意外看到了 Today’s Music - Mogwai，点开，音乐响起，大赞。收拾心情，重新上路。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/07/28/recent-readings-20190728-01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/28/recent-readings-20190728-01/" itemprop="url">近期浏览器阅读列表 (07-28)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-28T17:04:39+08:00">
                2019-07-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/07/28/recent-readings-20190728-01/" class="leancloud_visitors" data-flag-title="近期浏览器阅读列表 (07-28)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>题记：电脑若干天没关机，浏览器又.. 打开了一堆页面，大多数页面都「舍不得」关掉。所以决定在关闭之前把读过觉得有收获的几个网页做个简单摘要，同时也是作为备忘记录一下。</p>
<p>回想起一个多月前发表在「码农翻身」知识星球上的一段话。</p>
<blockquote>
<p>早上在微信主动搜索到的一篇关于注意力的文章。结合文章联想下我自己的「注意力漂移」坏习惯。经常在搜索某主题的时候，不断打开新的网页，然而又「舍不得关掉」，而且多数时候容易「跑题」，比如某网页里面提到了某个与当前搜索主题无关的内容，因为「好奇心」，马上去点开链接或者去搜索框搜索，以至于打开的网页越来越多。  </p>
<p>在想有没有这样的浏览器插件，如果没有做一个应该也不难。它是一个浏览器报警插件，功能很简单：「当同时打开的网页数量超过 xx 个的时候请给我报个警」。xx 默认设置成 10 个。</p>
<p>附上链接：<a href="https://mp.weixin.qq.com/s/eElXiqDhKs4qra02kM_lyQ" target="_blank" rel="noopener">李笑来：注意力飘逸</a></p>
</blockquote>
<p>最近在思索和探究一个问题：一个工业级的开源分布式系统，从开发到具备系统级运行之前是如果做测试的？带着这个疑问，我把注意力重新放回到了 kafka 的测试上面。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/07/28/recent-readings-20190728-01/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/07/12/explain-fork-and-star-on-github/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/12/explain-fork-and-star-on-github/" itemprop="url">GitHub 上 Fork 和 Star 两个操作的解释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-12T17:25:43+08:00">
                2019-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/07/12/explain-fork-and-star-on-github/" class="leancloud_visitors" data-flag-title="GitHub 上 Fork 和 Star 两个操作的解释">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>先抛出两个问题：</p>
<ol>
<li>star 和 fork 到底啥区别</li>
<li>fork 来的项目，在其之上做 commit，默认不会统计到个人页面的贡献值里</li>
</ol>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/07/12/explain-fork-and-star-on-github/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/07/11/programming-in-scala-reading-notes-ch4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/11/programming-in-scala-reading-notes-ch4/" itemprop="url">Programming In Scala 阅读笔记 - CH4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-11T09:34:36+08:00">
                2019-07-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/07/11/programming-in-scala-reading-notes-ch4/" class="leancloud_visitors" data-flag-title="Programming In Scala 阅读笔记 - CH4">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Scala 尽一切可能为我们提供程序的健壮性和简洁性。</p>
<h3 id="健壮"><a href="#健壮" class="headerlink" title="健壮"></a>健壮</h3><p>追求健壮性的重要手段是保证对象的状态始终有效。公共访问（public）是 Scala 的默认访问级别，可以通过将字段标记为私有（private）来防止外部直接访问。另外，Scala 方法参数的一个重要特征是它们都是 val 常量而非 var 变量。</p>
<h3 id="简洁"><a href="#简洁" class="headerlink" title="简洁"></a>简洁</h3><p>推荐编写方法的风格是「避免使用任何显示的 return 语句，尤其是多个 return」。在没有显示的 return 语句时，Scala 方法返回的是方法内部计算出的最后一个表达式的值。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/07/11/programming-in-scala-reading-notes-ch4/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/07/05/how-choose-number-topics-partitions-kafka-cluster/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/05/how-choose-number-topics-partitions-kafka-cluster/" itemprop="url">如何选择 kafka 的主题分区数量 - 译</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-05T08:56:06+08:00">
                2019-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/07/05/how-choose-number-topics-partitions-kafka-cluster/" class="leancloud_visitors" data-flag-title="如何选择 kafka 的主题分区数量 - 译">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>Kafka 的分区数据量会对性能产生哪些影响？最多能支持多大规模的分区数量？本文将从正面和负面两个维度做详细的分析。</p>
<p>本文讨论的内容适应于 Apache Kafka 1.1.0 之前的版本。1.1.0 版本做了很多优化，特别是单集群能够支持的分区总数有了 <a href="https://www.confluent.io/blog/apache-kafka-supports-200k-partitions-per-cluster" target="_blank" rel="noopener">显著提升</a>。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/07/05/how-choose-number-topics-partitions-kafka-cluster/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wxl24life.com/2019/06/28/install-ducktape-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="wxl24life">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/final.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="wxl24life's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/28/install-ducktape-notes/" itemprop="url">分布式系统性能测试工具 Ducktape 安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-28T15:31:28+08:00">
                2019-06-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2019/06/28/install-ducktape-notes/" class="leancloud_visitors" data-flag-title="分布式系统性能测试工具 Ducktape 安装">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>安装步骤参考官网 <a href="https://ducktape-docs.readthedocs.io/en/latest/install.html" target="_blank" rel="noopener">here</a>，工具介绍 <a href="https://github.com/confluentinc/ducktape" target="_blank" rel="noopener">here</a>。</p>
<p>由于我的系统环境是 OS X 10.12.6（python 系统版本 2.7.10）。本文主要记录在 OS X 环境下的安装步骤及遇到的问题。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/06/28/install-ducktape-notes/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/final.png" alt="wxl24life">
            
              <p class="site-author-name" itemprop="name">wxl24life</p>
              <p class="site-description motion-element" itemprop="description">有椒其馨,胡考之宁</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/wxl24life" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/wxl24life" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-globe"></i>Twitter</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wxl24life</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("7hsLgVUjtyEhhXatScAu9Y8h-gzGzoHsz", "nrsi6dnnpcL1D5IokXKQR5ni");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  


</body>
</html>
